var tjVAdmin={vendor:{readMore:function(){var e=Joomla.JText._("COM_TJVENDOR_DESCRIPTION_READ_MORE"),o=Joomla.JText._("COM_TJVENDOR_DESCRIPTION_READ_LESS");jQuery(".profile__content").each(function(){var o=jQuery(this).html();if(o.length>300){var t=o.substr(0,300)+'<span class="show"></span><span><span class="collapse">'+o.substr(300,o.length-300)+'</span>&nbsp;&nbsp;<a href="" class="morelink">'+e+"</a></span>";jQuery(this).html(t)}}),jQuery(".morelink").click(function(){return jQuery(this).hasClass("less")?(jQuery(this).removeClass("less"),jQuery(this).html(e)):(jQuery(this).addClass("less"),jQuery(this).html(o)),jQuery(this).parent().prev().toggle(),jQuery(this).prev().toggle(),!1})},initVendorJs:function(){jQuery(document).ready(function(){jQuery(document).on("change","#jform_user_id",function(){tjVAdmin.vendor.checkVendor()})}),jQuery(window).load(function(){tjCommon.vendorLogoValidation(),tjCommon.initVendorFields()}),Joomla.submitbutton=function(e){if("vendor.apply"==e||"vendor.save"==e||"vendor.save2new"==e){var o=document.formvalidator.isValid(document.getElementById("adminForm"));if(""==document.getElementById("jform_user_id").value){var t=[Joomla.JText._("COM_TJVENDOR_USER_ERROR")];Joomla.renderMessages({warning:t})}else 1==o&&Joomla.submitform(e,document.getElementById("adminForm"))}else Joomla.submitform(e,document.getElementById("adminForm"))}},changePayoutStatus:function(e,o){document.getElementById("paidUnpaid").value;var t={};t.payout_id=e,t.paidUnpaid=jQuery(o).val(),JSON.stringify(t),jQuery.ajax({type:"POST",dataType:"json",data:t,url:"index.php?option=com_tjvendors&task=payout.changePayoutStatus",success:function(e){e&&(document.location="index.php?option=com_tjvendors&view=reports&client="+client)}})},checkVendor:function(){var e=document.getElementById("jform_user_id_id").value,o={};o.user=e,o.vendor_id=vendor_id,JSON.stringify(o),jQuery.ajax({type:"POST",dataType:"json",data:o,url:"index.php?option=com_tjvendors&task=vendor.checkDuplicateUser",success:function(e){if(e){if("update"===layout){var o=[Joomla.JText._("COM_TJVENDOR_DUPLICARE_VENDOR_ERROR")];return Joomla.renderMessages({warning:o}),vendorCheck="exists"}document.location="index.php?option=com_tjvendors&view=vendor&layout=edit&client="+client+"&vendor_id="+e.vendor_id}}})}},vendors:{vendorApprove:function(e,o){vendorApprove=jQuery(o).val();var t={};t.vendor_id=e,t.vendorApprove=vendorApprove,t.client=client,JSON.stringify(t),jQuery.ajax({type:"POST",dataType:"json",data:t,url:"index.php?option=com_tjvendors&task=vendor.vendorApprove",success:function(e){if(alert(e),jQuery("#system-message-container").empty(),"1"==vendorApprove){var o=[Joomla.JText._("COM_TJVENDOR_VENDOR_APPROVAL")];Joomla.renderMessages({success:o})}else o=[Joomla.JText._("COM_TJVENDOR_VENDOR_DENIAL")],Joomla.renderMessages({success:o})}})}},fee:{initFeeJs:function(){Joomla.submitbutton=function(e){if("vendorfee.apply"==e||"vendorfee.save"==e){var o=document.getElementById("jform_percent_commission").value,t=document.getElementById("jform_flat_commission").value;if(o>100){var n=[Joomla.JText._("COM_TJVENDORS_FEES_PERCENT_ERROR")];Joomla.renderMessages({error:n})}else if(o<0||t<0){n=[Joomla.JText._("COM_TJVENDORS_FEES_NEGATIVE_NUMBER_ERROR")];Joomla.renderMessages({error:n})}else Joomla.submitform(e,document.getElementById("vendorfee-form"))}else"vendorfee.cancel"==e&&Joomla.submitform(e,document.getElementById("vendorfee-form"))}}},reports:{initReportsJs:function(){jQuery(document).ready(function(){jQuery("#dates").blur(function(){document.adminForm.submit()}),jQuery("#date").blur(function(){document.adminForm.submit()})})}}},tjVSite={vendor:{initVendorJs:function(){jQuery(document).ready(function(){jQuery(document).on("change","#jform_payment_gateway",function(){})}),jQuery(window).load(function(){tjCommon.vendorLogoValidation(),tjCommon.initVendorFields()}),Joomla.submitbutton=function(e){"vendor.save"==e?1==document.formvalidator.isValid(document.getElementById("adminForm"))&&Joomla.submitform(e,document.getElementById("adminForm")):Joomla.submitform(e,document.getElementById("adminForm"))}}},vendors:{initVendorsJs:function(){jQuery(document).ready(function(){jQuery("#dates, #date").blur(function(){jQuery("#adminForm").submit()})})},toggleDiv:function(e){jQuery(window).width()<767?jQuery("#"+e).toggle("slow"):jQuery("#"+e).toggle(),jQuery(".report_search_input").toggleClass("active")}}},tjCommon={vendorLogoValidation:function(){jQuery("#jform_vendor_logo").change(function(e){var o,t;(o=this.files[0])&&((t=new Image).onload=function(){if(o.size>vendorAllowedMediaSize)return alert(allowedMediaSizeErrorMessage),jQuery("#jform_vendor_logo").val(""),!1;(this.width<445||this.height<265)&&alert(allowedImageDimensionErrorMessage+this.width+"px X "+this.height+"px")},t.onerror=function(){return alert(allowedImageTypeErrorMessage+o.type),jQuery("#jform_vendor_logo").val(""),!1},t.src=_URL.createObjectURL(o))})},initVendorFields:function(){jQuery(".subform-repeatable-group .gateway_name").on("focus",function(){previous=this.value}),jQuery(".subform-repeatable-group .gateway_name").each(function(){jQuery(this).trigger("change")})},getGatewayFields:function(e){let o=0;if(jQuery(".subform-repeatable-group .gateway_name").each(function(){this.value===e.value&&o++}),o>1)return jQuery(e).val(),!1;let t={payment_gateway:e.value,parent_tag:e.name.replace("[payment_gateways]","")};tjCommon.generateGatewayFields(t,e.id)},generateGatewayFields:function(e,o){JSON.stringify(e),jQuery.ajax({type:"POST",dataType:"json",data:e,url:Joomla.getOptions("system.paths").base+"/index.php?option=com_tjvendors&task=vendor.generateGatewayFields",success:function(t){let n=jQuery("#"+o);if(n.closest(".subform-repeatable-group").find(".payment-gateway-parent").empty(),t)t.forEach(function(e){n.closest(".subform-repeatable-group").append("<div class='payment-gateway-parent'>"+e+"</div>")});else if(!t&&""!=e.payment_gateway){var r=Joomla.JText._("COM_TJVENDOR_PAYMENTGATEWAY_NO_FIELD_MESSAGE");n.closest(".subform-repeatable-group").append("<div class='alert alert-warning payment-gateway-parent'>"+r+"</div>")}}})}};